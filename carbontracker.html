<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Carbon Tracker - EcoVision</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,sans-serif;background:linear-gradient(135deg,#0d1b2a 0%,#1b263b 100%);min-height:100vh;color:#e0e1dd}
    .app-container{max-width:1400px;margin:0 auto;padding:20px}
    .header{background:rgba(27,38,59,.8);backdrop-filter:blur(10px);border-radius:20px;padding:30px;margin-bottom:30px;box-shadow:0 10px 30px rgba(0,0,0,.3);animation:slideDown .5s ease;border:1px solid rgba(255,255,255,.1);text-align:center}
    @keyframes slideDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
    .header h1{color:#e0e1dd;font-size:2.5em;margin-bottom:10px;background:linear-gradient(45deg,#4cc9f0,#2e6a4d);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 2px 10px rgba(76,201,240,.3)}
    .nav-tabs{display:flex;gap:10px;margin-bottom:30px;flex-wrap:wrap;justify-content:center}
    .nav-tab{background:rgba(65,90,119,.7);color:#e0e1dd;border:none;padding:15px 30px;border-radius:15px;cursor:pointer;font-size:1em;transition:all .3s ease;text-decoration:none;display:inline-block;backdrop-filter:blur(5px)}
    .nav-tab:hover{transform:translateY(-3px);box-shadow:0 10px 20px rgba(0,0,0,.2);background:rgba(76,107,148,.8)}
    .nav-tab.active{background:rgba(46,106,77,.8);box-shadow:0 0 15px rgba(46,106,77,.5)}
    .card{background:rgba(27,38,59,.8);backdrop-filter:blur(10px);border-radius:20px;padding:30px;margin-bottom:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);animation:fadeIn .5s ease;border:1px solid rgba(255,255,255,.1)}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:20px 0}
    .stat-card{background:linear-gradient(135deg,rgba(65,90,119,.7),rgba(46,106,77,.7));color:#e0e1dd;padding:25px;border-radius:15px;text-align:center;transition:all .3s ease;backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.1)}
    .stat-card:hover{transform:translateY(-5px);box-shadow:0 10px 25px rgba(0,0,0,.3)}
    .stat-number{font-size:2.5em;margin:10px 0;animation:countUp 1s ease;font-weight:bold;text-shadow:0 2px 10px rgba(0,0,0,.3)}
    @keyframes countUp{from{opacity:0;transform:scale(.5)}to{opacity:1;transform:scale(1)}}
    .input-section{margin:20px 0}
    .input-group{margin-bottom:20px;padding:20px;background:rgba(65,90,119,.3);border-radius:15px;backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.1)}
    .input-group label{display:block;margin-bottom:10px;color:#e0e1dd;font-weight:500;font-size:1.1em}
    .input-group input,.input-group select{padding:12px 15px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:rgba(10,25,41,.7);color:#e0e1dd;margin:8px 0;font-size:1em;width:100%;max-width:350px;transition:all .3s ease}
    .input-group input:focus,.input-group select:focus{outline:none;border-color:#4cc9f0;box-shadow:0 0 10px rgba(76,201,240,.3)}
    .calculate-btn{background:linear-gradient(135deg,#2e6a4d,#3a7d5c);color:#fff;border:none;padding:15px 40px;border-radius:50px;font-size:1.1em;font-weight:500;cursor:pointer;margin:15px 0;transition:all .3s ease;display:block;width:100%;max-width:350px;box-shadow:0 5px 15px rgba(46,106,77,.3)}
    .calculate-btn:hover{background:linear-gradient(135deg,#3a7d5c,#2e6a4d);transform:translateY(-3px);box-shadow:0 8px 20px rgba(46,106,77,.4)}
    .chart-container{position:relative;height:400px;margin:20px 0;background:rgba(27,38,59,.5);border-radius:15px;padding:15px;backdrop-filter:blur(5px)}
    .comparison-container{display:flex;justify-content:space-between;margin-top:25px;gap:20px}
    .comparison-item{flex:1;background:rgba(65,90,119,.5);padding:20px;border-radius:15px;text-align:center;backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.1);transition:all .3s ease}
    .comparison-item:hover{transform:translateY(-3px);box-shadow:0 10px 20px rgba(0,0,0,.2)}
    .comparison-value{font-size:1.8em;font-weight:bold;margin:10px 0;color:#4cc9f0;text-shadow:0 2px 5px rgba(0,0,0,.3)}
    .insights-container{margin-top:25px;padding:25px;background:rgba(65,90,119,.3);border-radius:15px;backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.1)}
    .insight-item{margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid rgba(255,255,255,.1);animation:slideIn .5s ease}
    @keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}
    .insight-item:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0}
    .insight-item h4{color:#4cc9f0;margin-bottom:10px;font-size:1.2em}
    .insight-item ul{padding-left:20px;margin-top:10px}
    .insight-item li{margin-bottom:8px;line-height:1.5}
    .date-display{text-align:center;margin:15px 0;font-size:1.2em;color:#4cc9f0;font-weight:500;text-shadow:0 2px 5px rgba(0,0,0,.3)}
    .history-controls{display:flex;justify-content:space-between;margin:20px 0;align-items:center}
    .history-btn{background:rgba(65,90,119,.7);color:#fff;border:none;padding:10px 20px;border-radius:10px;cursor:pointer;font-size:1em;transition:all .3s ease;backdrop-filter:blur(5px)}
    .history-btn:hover{background:rgba(76,107,148,.8);transform:translateY(-2px)}
    h2{margin-bottom:20px;color:#e0e1dd;position:relative;display:inline-block;font-size:1.8em}
    h2::after{content:'';position:absolute;bottom:-10px;left:0;width:50px;height:3px;background:linear-gradient(90deg,#2e6a4d,#4cc9f0);border-radius:3px}
    @media (max-width:768px){.comparison-container{flex-direction:column}.nav-tabs{flex-direction:column}.nav-tab{width:100%;text-align:center}.history-controls{flex-direction:column;gap:10px}.chart-container{height:300px}.stat-number{font-size:2em}}
  </style>
</head>
<body>
  <div class="app-container">
    <div class="header">
      <h1>Carbon Footprint Tracker</h1>
      <p>Monitor and reduce your daily carbon emissions</p>
      <div class="date-display" id="currentDate">Loading date...</div>
    </div>

    <div class="nav-tabs">
      <a href="index.html" class="nav-tab">Waste Classifier</a>
      <a href="carbontracker.html" class="nav-tab active">Carbon Tracker</a>
      <a href="ecochallenges.html" class="nav-tab">Eco Challenges</a>
      <a href="impactdashboard.html" class="nav-tab">Impact Dashboard</a>
      <a href="community.html" class="nav-tab">Community</a>
    </div>

    <div class="card">
      <h2>Your Carbon Footprint</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Daily CO₂</h3>
          <div class="stat-number" id="dailyCO2">0</div>
          <p>kg CO₂</p>
        </div>
        <div class="stat-card">
          <h3>Weekly CO₂</h3>
          <div class="stat-number" id="weeklyCO2">0</div>
          <p>kg CO₂</p>
        </div>
        <div class="stat-card">
          <h3>Trees to Offset</h3>
          <div class="stat-number" id="treesNeeded">0</div>
          <p>trees/year</p>
        </div>
        <div class="stat-card">
          <h3>Savings</h3>
          <div class="stat-number" id="savings">0</div>
          <p>kg CO₂ saved vs average</p>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Calculate Your Carbon Footprint</h2>
      <div class="input-section">
        <div class="input-group">
          <label>Transportation (daily distance):</label>
          <select id="transportType">
            <option value="0">Walking/Cycling (0 kg/km)</option>
            <option value="0.05">Public Transport (0.05 kg/km)</option>
            <option value="0.11">Car (Electric) (0.11 kg/km)</option>
            <option value="0.19" selected>Car (Gasoline) (0.19 kg/km)</option>
            <option value="0.25">Car (SUV) (0.25 kg/km)</option>
          </select>
          <input type="number" id="transportDistance" placeholder="Distance (km)" value="20" min="0"/>
        </div>
        <div class="input-group">
          <label>Home Energy Usage:</label>
          <input type="number" id="energyUsage" placeholder="kWh per day" value="10" min="0"/>
          <p style="font-size:.9em;margin-top:5px;color:#b6c2cf;">Average household: 10-15 kWh/day</p>
        </div>
        <div class="input-group">
          <label>Diet Type:</label>
          <select id="dietType">
            <option value="2.5">Vegan (2.5 kg/day)</option>
            <option value="3.2">Vegetarian (3.2 kg/day)</option>
            <option value="4.1">Pescatarian (4.1 kg/day)</option>
            <option value="5.3" selected>Regular (5.3 kg/day)</option>
            <option value="7.1">Heavy Meat (7.1 kg/day)</option>
          </select>
        </div>
        <button class="calculate-btn" onclick="save_today()">Save Today's Carbon Footprint</button>
      </div>

      <div class="comparison-container">
        <div class="comparison-item">
          <h4>Your Daily Emissions</h4>
          <div class="comparison-value" id="userDaily">0 kg</div>
          <p>CO₂ per day</p>
        </div>
        <div class="comparison-item">
          <h4>Average Person</h4>
          <div class="comparison-value">14 kg</div>
          <p>CO₂ per day</p>
        </div>
        <div class="comparison-item">
          <h4>Climate Target</h4>
          <div class="comparison-value">10 kg</div>
          <p>CO₂ per day</p>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>CO₂ Emissions Trend</h2>
      <div class="history-controls">
        <button class="history-btn" onclick="change_week(-1)">Previous Week</button>
        <span id="weekDisplay">Loading...</span>
        <button class="history-btn" onclick="change_week(1)">Next Week</button>
      </div>
      <div class="chart-container">
        <canvas id="carbonChart"></canvas>
      </div>
    </div>

    <div class="card">
      <h2>Emission Breakdown & Insights</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Transportation</h3>
          <div class="stat-number" id="transportCO2">0</div>
          <p>kg CO₂</p>
        </div>
        <div class="stat-card">
          <h3>Energy</h3>
          <div class="stat-number" id="energyCO2">0</div>
          <p>kg CO₂</p>
        </div>
        <div class="stat-card">
          <h3>Diet</h3>
          <div class="stat-number" id="dietCO2">0</div>
          <p>kg CO₂</p>
        </div>
      </div>
      <div class="insights-container" id="insights">
        <h3>Reduction Tips</h3>
        <p>Calculate your footprint to see personalized recommendations</p>
      </div>
    </div>
  </div>

  <script>
    let data = {};
    let chart;
    let week_offset = 0;

    function init(){
      set_date();
      load_data();
      init_chart();
      save_today();
    }

    function set_date(){
      const today = new Date();
      const opts = { weekday:'long', year:'numeric', month:'long', day:'numeric' };
      document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', opts);
    }

    function load_data(){
      const saved = localStorage.getItem('carbonFootprintData');
      if (saved){
        data = JSON.parse(saved);
      } else {
        data = { entries:{}, weeklyAverages:{} };
      }
    }

    function save_store(){
      localStorage.setItem('carbonFootprintData', JSON.stringify(data));
    }

    function init_chart(){
      const ctx = document.getElementById('carbonChart').getContext('2d');
      chart = new Chart(ctx, {
        type:'line',
        data:{
          labels: week_days(week_offset),
          datasets:[{
            label:'Daily CO₂ (kg)',
            data: week_data(week_offset),
            borderColor:'#4cc9f0',
            backgroundColor:'rgba(76, 201, 240, 0.1)',
            tension:.3,
            fill:true,
            pointBackgroundColor:'#2e6a4d',
            pointBorderColor:'#fff',
            pointRadius:5,
            pointHoverRadius:7
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{ labels:{ color:'#e0e1dd', font:{ size:14 } } },
            tooltip:{
              backgroundColor:'rgba(27, 38, 59, 0.9)',
              titleColor:'#4cc9f0',
              bodyColor:'#e0e1dd',
              borderColor:'rgba(76, 201, 240, 0.3)',
              borderWidth:1,
              callbacks:{ label:(c)=>`CO₂: ${c.raw} kg` }
            }
          },
          scales:{
            y:{
              beginAtZero:true,
              ticks:{ color:'#e0e1dd', font:{ size:12 } },
              grid:{ color:'rgba(224, 225, 221, 0.1)' },
              title:{ display:true, text:'kg CO₂', color:'#e0e1dd', font:{ size:14, weight:'bold' } }
            },
            x:{
              ticks:{ color:'#e0e1dd', font:{ size:12 } },
              grid:{ color:'rgba(224, 225, 221, 0.1)' }
            }
          }
        }
      });
      update_week_label();
    }

    function week_days(offset){
      const today = new Date();
      const start = new Date(today);
      start.setDate(start.getDate() + (offset*7));
      while (start.getDay() !== 0){ start.setDate(start.getDate() - 1); }
      const days = [];
      for (let i=0;i<7;i++){
        const d = new Date(start);
        d.setDate(d.getDate()+i);
        days.push(d.toLocaleDateString('en-US',{ weekday:'short' }));
      }
      return days;
    }

    function week_data(offset){
      const today = new Date();
      const start = new Date(today);
      start.setDate(start.getDate() + (offset*7));
      while (start.getDay() !== 0){ start.setDate(start.getDate() - 1); }
      const out = [];
      for (let i=0;i<7;i++){
        const d = new Date(start);
        d.setDate(d.getDate()+i);
        const key = d.toISOString().split('T')[0];
        if (data.entries && data.entries[key]){
          out.push(data.entries[key].total);
        } else {
          out.push(0);
        }
      }
      return out;
    }

    function update_week_label(){
      const today = new Date();
      const start = new Date(today);
      start.setDate(start.getDate() + (week_offset*7));
      while (start.getDay() !== 0){ start.setDate(start.getDate() - 1); }
      const end = new Date(start);
      end.setDate(end.getDate()+6);
      const opts = { month:'short', day:'numeric', year:'numeric' };
      const txt = `Week of ${start.toLocaleDateString('en-US', opts)}`;
      document.getElementById('weekDisplay').textContent = txt;
    }

    function change_week(dir){
      week_offset += dir;
      redraw();
    }

    function redraw(){
      if (chart){
        chart.data.labels = week_days(week_offset);
        chart.data.datasets[0].data = week_data(week_offset);
        chart.update();
      }
      update_week_label();
    }

    function save_today(){
      const transport_factor = parseFloat(document.getElementById('transportType').value);
      const distance = parseFloat(document.getElementById('transportDistance').value) || 0;
      const energy = parseFloat(document.getElementById('energyUsage').value) || 0;
      const diet = parseFloat(document.getElementById('dietType').value);

      const transport_co2 = transport_factor * distance;
      const energy_co2 = energy * 0.4;
      const diet_co2 = diet;
      const daily_co2 = transport_co2 + energy_co2 + diet_co2;

      document.getElementById('dailyCO2').textContent = daily_co2.toFixed(1);
      document.getElementById('weeklyCO2').textContent = (daily_co2*7).toFixed(1);
      document.getElementById('treesNeeded').textContent = (daily_co2*365/21.77).toFixed(1);

      const avg_daily = 14;
      const save = Math.max(0, avg_daily - daily_co2);
      document.getElementById('savings').textContent = save.toFixed(1);

      document.getElementById('transportCO2').textContent = transport_co2.toFixed(1);
      document.getElementById('energyCO2').textContent = energy_co2.toFixed(1);
      document.getElementById('dietCO2').textContent = diet_co2.toFixed(1);
      document.getElementById('userDaily').textContent = daily_co2.toFixed(1) + ' kg';

      const today = new Date();
      const key = today.toISOString().split('T')[0];
      if (!data.entries) data.entries = {};
      data.entries[key] = { date:key, transport:transport_co2, energy:energy_co2, diet:diet_co2, total:daily_co2 };

      save_store();
      redraw();
      make_tips(transport_co2, energy_co2, diet_co2, daily_co2);
    }

    function make_tips(t_co2, e_co2, d_co2, total){
      const wrap = document.getElementById('insights');
      let html = '<h3>Reduction Tips</h3>';
      if (t_co2 > 2){
        html += `
          <div class="insight-item">
            <h4>Transportation</h4>
            <p>Your transportation emits ${t_co2.toFixed(1)} kg CO₂ daily. Consider:</p>
            <ul>
              <li>Using public transport 2 days/week could save ${(t_co2*0.3).toFixed(1)} kg CO₂ daily</li>
              <li>Carpooling could reduce your transport emissions by 25-30%</li>
            </ul>
          </div>
        `;
      }
      if (e_co2 > 3){
        html += `
          <div class="insight-item">
            <h4>Home Energy</h4>
            <p>Your home energy use emits ${e_co2.toFixed(1)} kg CO₂ daily. Consider:</p>
            <ul>
              <li>Switching to LED bulbs could save up to 0.3 kg CO₂ daily</li>
              <li>Unplugging electronics when not in use could save 0.5 kg CO₂ daily</li>
            </ul>
          </div>
        `;
      }
      if (d_co2 > 4){
        html += `
          <div class="insight-item">
            <h4>Diet</h4>
            <p>Your food choices emit ${d_co2.toFixed(1)} kg CO₂ daily. Consider:</p>
            <ul>
              <li>Meat-free days could save ${(d_co2*0.2).toFixed(1)} kg CO₂ per day</li>
              <li>Buying local produce could reduce food transport emissions by 5-10%</li>
            </ul>
          </div>
        `;
      }
      if (total < 5){
        html += `
          <div class="insight-item">
            <h4>Excellent!</h4>
            <p>Your carbon footprint is below the climate target of 5 kg CO₂ per day. You're making a significant positive impact!</p>
          </div>
        `;
      } else if (total < 10){
        html += `
          <div class="insight-item">
            <h4>Good Progress</h4>
            <p>Your carbon footprint is better than average (14 kg), but there's room for improvement to reach the climate target of 5 kg CO₂ per day.</p>
          </div>
        `;
      } else {
        html += `
          <div class="insight-item">
            <h4>Reduction Opportunities</h4>
            <p>Your carbon footprint is higher than average. Focus on your highest emission areas first to make the biggest impact.</p>
          </div>
        `;
      }
      wrap.innerHTML = html;
    }

    window.onload = init;
  </script>
</body>
</html>
